plot(b$date, b$mean_high_c)
b <- data %>% filter(year == 2021, month == 10, day > 20)
b
plot(b$date, b$mean_high_c)
plot(b$date, ((b$mean_high_c *  9/5) + 32))
nrow(b)
b %>% count(census_block_group, mean_high_c)
b %>% count(census_block_group, region)
c <- b %>% count(census_block_group, region)
unique(c$n)
t <- read_rds("./heatwaves_manual/bay_temperature_clean_blockgroup_03_2022.RDS")
head(t)
b <- t %>% filter(year == 2021, month == 10)
plot(b$date, ((b$mean_high_c *  9/5) + 32))
b <- t %>% filter(year == 2021, month == 10, !is.na(mean_high_c))
plot(b$date, ((b$mean_high_c *  9/5) + 32))
head(b)
quants <- c(.05, .5, .95)
coefs <- quantile(coefs, quants)
plot_data <- as.data.frame(x = 11000:350000)
colnames(plot_data) <- x
colnames(plot_data)
colnames(plot_data) <- c("x")
colnames(plot_data)
plot_data
plot_data <- plot_data %>% mutate(y = (x * coefs[2]) - 88000,
upper = (x * coefs[3]) - 88000,
lower = (x * coefs[1]) - 88000) #suntracting median of all income
plot_data
head(plot_data)
tail(plot_data)
coefs
m
plot_title = "felm(visitors_percap ~ median_income | county + monthweek)"
ggplot(data = plot_data, aes(x, y))+
geom_ribbon(data = plot_data, aes(ymin = lower, ymax = upper), linetype=2, alpha = 0.25) +
geom_line(data = plot_data, aes(x, y))+
labs(title = plot_title) +
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
which(x == 88000)
quants <- c(.05, .5, .95)
coefs <- quantile(coefs, quants)
plot_data <- as.data.frame(x = 11000:350000)
colnames(plot_data) <- c("x")
plot_data <- plot_data %>% mutate(y = (x * coefs[2]),
upper = (x * coefs[3]),
lower = (x * coefs[1])) #suntracting median of all income
plot_title = "felm(visitors_percap ~ median_income | county + monthweek)"
ggplot(data = plot_data, aes(x, y))+
geom_ribbon(data = plot_data, aes(ymin = lower, ymax = upper), linetype=2, alpha = 0.25) +
geom_line(data = plot_data, aes(x, y))+
labs(title = plot_title) +
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
head(plot_data)
88000+11000
quants <- c(.05, .5, .95)
coefs <- quantile(coefs, quants)
plot_data <- as.data.frame(x = 11000:350000)
colnames(plot_data) <- c("x")
plot_data <- plot_data %>% mutate(y = (x * coefs[2]),
upper = (x * coefs[3]),
lower = (x * coefs[1])) #subtracting median of all income
plot_data <- plot_data %>% mutate(y = y - plot_data[2, 99000],
uppper = upper - plot_data[3, 99000],
lower = lower - plot_data[4, 99000])
plot_title = "felm(visitors_percap ~ median_income | county + monthweek)"
ggplot(data = plot_data, aes(x, y))+
geom_ribbon(data = plot_data, aes(ymin = lower, ymax = upper), linetype=2, alpha = 0.25) +
geom_line(data = plot_data, aes(x, y))+
labs(title = plot_title) +
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
quants <- c(.05, .5, .95)
coefs <- quantile(coefs, quants)
plot_data <- as.data.frame(x = 11000:350000)
colnames(plot_data) <- c("x")
plot_data <- plot_data %>% mutate(y = (x * coefs[2]),
upper = (x * coefs[3]),
lower = (x * coefs[1])) #subtracting median of all income
plot_data <- plot_data %>% mutate(y = y - plot_data[99000, 2],
uppper = upper - plot_data[99000, 3],
lower = lower - plot_data[99000, 4])
plot_title = "felm(visitors_percap ~ median_income | county + monthweek)"
ggplot(data = plot_data, aes(x, y))+
geom_ribbon(data = plot_data, aes(ymin = lower, ymax = upper), linetype=2, alpha = 0.25) +
geom_line(data = plot_data, aes(x, y))+
labs(title = plot_title) +
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
plot_data[,2]
head(plot_data[,2])
head(plot_data)
plot_data[,2][x=88000]
plot_data[,3][x=88000]
plot_data[,4][x=88000]
plot_data <- as.data.frame(x = 11000:350000)
colnames(plot_data) <- c("x")
plot_data <- plot_data %>% mutate(y = (x * coefs[2]),
upper = (x * coefs[3]),
lower = (x * coefs[1])) #subtracting median of all income
plot_data <- plot_data %>% mutate(y = y - plot_data[2][x = 88000],
uppper = upper - plot_data[3][x=88000],
lower = lower - plot_data[4][x=88000])
plot_title = "felm(visitors_percap ~ median_income | county + monthweek)"
ggplot(data = plot_data, aes(x, y))+
geom_ribbon(data = plot_data, aes(ymin = lower, ymax = upper), linetype=2, alpha = 0.25) +
geom_line(data = plot_data, aes(x, y))+
labs(title = plot_title) +
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
plot_data[2][x = 88000]
head(plot_data)
quants <- c(.05, .5, .95)
coefs <- quantile(coefs, quants)
plot_data <- as.data.frame(x = 11000:350000)
colnames(plot_data) <- c("x")
plot_data <- plot_data %>% mutate(y = (x * coefs[2]),
upper = (x * coefs[3]),
lower = (x * coefs[1])) #subtracting median of all income
plot_data <- plot_data %>% mutate(y = y - plot_data[,2][x = 88000],
uppper = upper - plot_data[,3][x=88000],
lower = lower - plot_data[,4][x=88000])
plot_title = "felm(visitors_percap ~ median_income | county + monthweek)"
ggplot(data = plot_data, aes(x, y))+
geom_ribbon(data = plot_data, aes(ymin = lower, ymax = upper), linetype=2, alpha = 0.25) +
geom_line(data = plot_data, aes(x, y))+
labs(title = plot_title) +
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
## get total number of counties experiencing extreme temperatures
a <- data_subset %>% filter(mean_high_c >= 34) %>% count(date, region)
data_subset <- left_join(data_subset, a, by = "date")
head(data_subset)
coefs <- c()
for(i in 1:10) {
samp <- sample(1:nrow(data_subset), nrow(data_subset), replace = T)
ds <- data_subset[samp,]
m <- felm(visitors_percap ~ n | census_block_group + monthweek, data = ds)
coefs <- rbind(m$coefficients, coefs)
}
quants <- c(.05, .5, .95)
coefs <- quantile(coefs, quants)
plot_data <- as.data.frame(x = 11000:350000)
colnames(plot_data) <- c("x")
plot_data <- plot_data %>% mutate(y = (x * coefs[2]),
upper = (x * coefs[3]),
lower = (x * coefs[1])) #subtracting median of all income
plot_data <- plot_data %>% mutate(y = y - plot_data[,2][x = 88000],
uppper = upper - plot_data[,3][x=88000],
lower = lower - plot_data[,4][x=88000])
plot_title = "visitors_percap ~ n | census_block_group + monthweek"
ggplot(data = plot_data, aes(x, y))+
geom_ribbon(data = plot_data, aes(ymin = lower, ymax = upper), linetype=2, alpha = 0.25) +
geom_line(data = plot_data, aes(x, y))+
labs(title = plot_title) +
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
plot_data
plot_data[,2][x = 88000]
plot_data[,2]
upper - plot_data[,3][x=88000]
plot_data[,3][x=88000]
plot_data[,4][x=88000]
nrow(plot_data)
plot_data[99000]
plot_data[99000,]
head(plot_data)
plot_data[x=88000]
plot_data[x=88000,]
plot_data[,x=88000]
plot_data[99000,]
plot_data[88000,]
plot_data[78000,]
plot_data[77000,]
plot_data[77001,]
plot_data <- as.data.frame(x = 11000:350000)
colnames(plot_data) <- c("x")
plot_data <- plot_data %>% mutate(y = (x * coefs[2]),
upper = (x * coefs[3]),
lower = (x * coefs[1])) #subtracting median of all income
plot_data <- plot_data %>% mutate(y = y - plot_data[77001,2],
uppper = upper - plot_data[77001,3],
lower = lower - plot_data[77001,4])
plot_title = "visitors_percap ~ n | census_block_group + monthweek"
ggplot(data = plot_data, aes(x, y))+
geom_ribbon(data = plot_data, aes(ymin = lower, ymax = upper), linetype=2, alpha = 0.25) +
geom_line(data = plot_data, aes(x, y))+
labs(title = plot_title) +
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
coefs
yy <- x*coefs
x*coefs[2]
yy <- x*coefs[2]
yy[x=20]
nrow(yy)
head(yy)
yy[,20]
yy[20,]
yy[20]
y[77001]
y[77001,]
yy[77001]
nrow(yy)
length(yy)
x*coefs[2]
yy <- x*coefs[2]
nrow(yy)
length(yy)
plot_data <- as.data.frame(x = 11000:350000)
head(plot_data)
colnames(plot_data) <- c("x")
yy <- plot_data$x * coefs[2]
length(yy)
yy[x=77001]
yy <- yy - yy[x=77001]
head(yy)
y <- plot_data$x * coefs[2]
quants <- c(.05, .5, .95)
coefs <- quantile(coefs, quants)
plot_data <- as.data.frame(x = 11000:350000)
colnames(plot_data) <- c("x")
y <- plot_data$x * coefs[2]
plot_data$y <- y - y[x=77001]
upper <- plot_data$x * coefs[3]
plot_data$upper <- upper - upper[x=77001]
lower <- plot_data$x * coefs[1]
plot_data$lower <- lower - lower[x=77001]
plot_title = "visitors_percap ~ n | census_block_group + monthweek"
ggplot(data = plot_data, aes(x, y))+
geom_ribbon(data = plot_data, aes(ymin = lower, ymax = upper), linetype=2, alpha = 0.25) +
geom_line(data = plot_data, aes(x, y))+
labs(title = plot_title) +
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
data_subset %>% mutate(n_bin = ntile(n_bin, 5))
data_subset %>% mutate(n_bin = ntile(n, 5))
data_subset <- data_subset %>% mutate(n_bin = ntile(n, 6))
m <- felm(visitors_percap ~ n_bin | census_block_group + monthweek, data=data_subset)
tidy(m)
n
m$coefficients
m <- felm(visitors_percap ~ as.factor(n_bin) | census_block_group + monthweek, data=data_subset)
m
m$coefficients
tidy(m)
c(0, m$coefficients)
cbind(1:6, c(0, m$coefficients))
cbind(x = 1:6, y = c(0, m$coefficients))
m <- felm(visitors_percap ~ as.factor(n_bin) | census_block_group + monthweek, data=data_subset)
m <- cbind(x = 1:6, y = c(0, m$coefficients))
## plot both the 2018-19 and 2020 data
ggplot(data = m, aes(x, y))+
geom_point(data = coefs, aes(x, y))+
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
m <- felm(visitors_percap ~ as.factor(n_bin) | census_block_group + monthweek, data=data_subset)
m <- as.data.frame(cbind(x = 1:6, y = c(0, m$coefficients)))
## plot both the 2018-19 and 2020 data
ggplot(data = m, aes(x, y))+
geom_point(data = coefs, aes(x, y))+
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
m
## plot both the 2018-19 and 2020 data
ggplot(data = m, aes(x, y))+
geom_point(data = m, aes(x, y))+
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
data_subset <- data_subset %>% mutate(n_bin = ntile(n, 8))
m <- felm(visitors_percap ~ as.factor(n_bin) | census_block_group + monthweek, data=data_subset)
m <- as.data.frame(cbind(x = 1:6, y = c(0, m$coefficients)))
## plot both the 2018-19 and 2020 data
ggplot(data = m, aes(x, y))+
geom_point(data = m, aes(x, y))+
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
data_subset <- data_subset %>% mutate(n_bin = ntile(n, 8))
m <- felm(visitors_percap ~ as.factor(n_bin) | census_block_group + monthweek, data=data_subset)
m <- as.data.frame(cbind(x = 1:7, y = c(0, m$coefficients)))
## plot both the 2018-19 and 2020 data
ggplot(data = m, aes(x, y))+
geom_point(data = m, aes(x, y))+
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
data_subset <- data_subset %>% mutate(n_bin = ntile(n, 10))
m <- felm(visitors_percap ~ as.factor(n_bin) | census_block_group + monthweek, data=data_subset)
m <- as.data.frame(cbind(x = 1:7, y = c(0, m$coefficients)))
## plot both the 2018-19 and 2020 data
ggplot(data = m, aes(x, y))+
geom_point(data = m, aes(x, y))+
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
data_subset <- data_subset %>% mutate(n_bin = ntile(n, 10))
m <- felm(visitors_percap ~ as.factor(n_bin) | census_block_group + monthweek, data=data_subset)
m <- as.data.frame(cbind(x = 1:9, y = c(0, m$coefficients)))
## plot both the 2018-19 and 2020 data
ggplot(data = m, aes(x, y))+
geom_point(data = m, aes(x, y))+
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
data_subset <- data_subset %>% mutate(n_bin = ntile(n, 5))
m <- felm(visitors_percap ~ as.factor(n_bin) | census_block_group + monthweek, data=data_subset)
m <- as.data.frame(cbind(x = 1:5, y = c(0, m$coefficients)))
## plot both the 2018-19 and 2020 data
ggplot(data = m, aes(x, y))+
geom_point(data = m, aes(x, y))+
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
data_subset <- data_subset %>% mutate(n_bin = ntile(n, 20))
m <- felm(visitors_percap ~ as.factor(n_bin) | census_block_group + monthweek, data=data_subset)
m <- as.data.frame(cbind(x = 1:20, y = c(0, m$coefficients)))
## plot both the 2018-19 and 2020 data
ggplot(data = m, aes(x, y))+
geom_point(data = m, aes(x, y))+
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
data_subset <- data_subset %>% mutate(n_bin = ntile(n, 15))
m <- felm(visitors_percap ~ as.factor(n_bin) | census_block_group + monthweek, data=data_subset)
m <- as.data.frame(cbind(x = 1:15, y = c(0, m$coefficients)))
## plot both the 2018-19 and 2020 data
ggplot(data = m, aes(x, y))+
geom_point(data = m, aes(x, y))+
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
data_subset <- data_subset %>% mutate(n_bin = ntile(n, 10))
m <- felm(visitors_percap ~ as.factor(n_bin) | census_block_group + monthweek, data=data_subset)
m <- as.data.frame(cbind(x = 1:10, y = c(0, m$coefficients)))
## plot both the 2018-19 and 2020 data
ggplot(data = m, aes(x, y))+
geom_point(data = m, aes(x, y))+
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
m <- felm(visitors_percap ~ poly(n, 2,raw=T)) | census_block_group + monthweek, data=data_subset)
m <- felm(visitors_percap ~ poly(n, 2,raw=T) | census_block_group + monthweek, data=data_subset)
m
m$coefficients
cbind(m$coefficients, m$coefficients)
rbind(m$coefficients, m$coefficients)
cbind(m$coefficients, m$coefficients, m$coefficients)
c<- cbind(m$coefficients, m$coefficients, m$coefficients)
quantile(c, quants)
quantile(c[2,], quants)
quantile(c[1,], quants)
coefs <- c()
for(i in 1:10) {
samp <- sample(1:nrow(data_subset), nrow(data_subset), replace = T)
ds <- data_subset[samp,]
m <- felm(visitors_percap ~ poly(n, 2, raw = T) | census_block_group + monthweek, data = ds)
coefs <- cbind(m$coefficients, coefs)
}
quants <- c(.05, .5, .95)
coefs_1 <- quantile(coefs[1,], quants)
coefs_2 <- quantile(coefs[2,], quants)
plot_data <- as.data.frame(x = 11000:350000)
colnames(plot_data) <- c("x")
y <- x*coefs_1[2] + x^2*coefs_2[2]
plot_data$y <- y - y[x=77001]
upper <- x*coefs_1[3] + x^2*coefs_2[3]
plot_data$upper <- upper - upper[x=77001]
lower <- x*coefs_1[1] + x^2*coefs_2[1]
plot_data$lower <- lower - lower[x=77001]
plot_title = "visitors_percap ~ n | census_block_group + monthweek"
coefs
quants <- c(.05, .5, .95)
coefs_1 <- quantile(coefs[1,], quants)
coefs_11
coefs_1
coefs_2 <- quantile(coefs[2,], quants)
plot_data <- as.data.frame(x = 11000:350000)
colnames(plot_data) <- c("x")
y <- plot_data$x*coefs_1[2] + plot_data$x^2*coefs_2[2]
plot_data$y <- y - y[x=77001]
upper <- plot_data$x*coefs_1[3] + plot_data$x^2*coefs_2[3]
plot_data$upper <- upper - upper[x=77001]
lower <- plot_data$x*coefs_1[1] + plot_data$x^2*coefs_2[1]
plot_data$lower <- lower - lower[x=77001]
plot_title = "visitors_percap ~ n | census_block_group + monthweek"
ggplot(data = plot_data, aes(x, y))+
geom_ribbon(data = plot_data, aes(ymin = lower, ymax = upper), linetype=2, alpha = 0.25) +
geom_line(data = plot_data, aes(x, y))+
labs(title = plot_title) +
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
max(data_subset$n)
quants <- c(.05, .5, .95)
coefs_1 <- quantile(coefs[1,], quants)
coefs_2 <- quantile(coefs[2,], quants)
plot_data <- as.data.frame(x = 1:4700)
colnames(plot_data) <- c("x")
y <- plot_data$x*coefs_1[2] + plot_data$x^2*coefs_2[2]
plot_data$y <- y - y[x=77001]
upper <- plot_data$x*coefs_1[3] + plot_data$x^2*coefs_2[3]
plot_data$upper <- upper - upper[x=77001]
lower <- plot_data$x*coefs_1[1] + plot_data$x^2*coefs_2[1]
plot_data$lower <- lower - lower[x=77001]
plot_title = "visitors_percap ~ n | census_block_group + monthweek"
ggplot(data = plot_data, aes(x, y))+
geom_ribbon(data = plot_data, aes(ymin = lower, ymax = upper), linetype=2, alpha = 0.25) +
geom_line(data = plot_data, aes(x, y))+
labs(title = plot_title) +
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
quants <- c(.05, .5, .95)
coefs_1 <- quantile(coefs[1,], quants)
coefs_2 <- quantile(coefs[2,], quants)
plot_data <- as.data.frame(x = 1:4700)
colnames(plot_data) <- c("x")
y <- plot_data$x*coefs_1[2] + plot_data$x^2*coefs_2[2]
plot_data$y <- y - y[x=77001]
plot_data
head(plot_data)
coefs
coefs_1
coefs[1,]
coefs[1]
coefs_1
plot_data$x*coefs_1[2]
coefs_2
plot_data$x^2*coefs_2[2]
y <- plot_data$x*coefs_1[2] + plot_data$x^2*coefs_2[2]
mean(data_subset$n)
median(data_subset$n)
quants <- c(.05, .5, .95)
coefs_1 <- quantile(coefs[1,], quants)
coefs_2 <- quantile(coefs[2,], quants)
plot_data <- as.data.frame(x = 1:4700)
colnames(plot_data) <- c("x")
y <- plot_data$x*coefs_1[2] + plot_data$x^2*coefs_2[2]
plot_data$y <- y - y[x=259]
upper <- plot_data$x*coefs_1[3] + plot_data$x^2*coefs_2[3]
plot_data$upper <- upper - upper[x=259]
lower <- plot_data$x*coefs_1[1] + plot_data$x^2*coefs_2[1]
plot_data$lower <- lower - lower[x=259]
plot_title = "visitors_percap ~ n | census_block_group + monthweek"
ggplot(data = plot_data, aes(x, y))+
geom_ribbon(data = plot_data, aes(ymin = lower, ymax = upper), linetype=2, alpha = 0.25) +
geom_line(data = plot_data, aes(x, y))+
labs(title = plot_title) +
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
y <- plot_data$x*coefs_1[2] + plot_data$x^2*coefs_2[2]
plot_data$y <- y - y[x=740]
upper <- plot_data$x*coefs_1[3] + plot_data$x^2*coefs_2[3]
plot_data$upper <- upper - upper[x=740]
lower <- plot_data$x*coefs_1[1] + plot_data$x^2*coefs_2[1]
plot_data$lower <- lower - lower[x=740]
ggplot(data = plot_data, aes(x, y))+
geom_ribbon(data = plot_data, aes(ymin = lower, ymax = upper), linetype=2, alpha = 0.25) +
geom_line(data = plot_data, aes(x, y))+
labs(title = plot_title) +
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
ggplot(data = plot_data, aes(x, y))+
geom_ribbon(data = plot_data, aes(ymin = lower, ymax = upper), linetype=2, alpha = 0.25) +
geom_line(data = plot_data, aes(x, y))+
labs(title = plot_title, x = "num CBGs >= 34C") +
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
plot_title = "MI change as number of CBGs with temps > 34 increases \n
visitors_percap ~ poly(n, 2, raw = T) | census_block_group + monthweek"
ggplot(data = plot_data, aes(x, y))+
geom_ribbon(data = plot_data, aes(ymin = lower, ymax = upper), linetype=2, alpha = 0.25) +
geom_line(data = plot_data, aes(x, y))+
labs(title = plot_title, x = "num CBGs >= 34C", y = "unit change in MI") +
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
plot_title = "MI change as number of CBGs with temps > 34 increases
visitors_percap ~ poly(n, 2, raw = T) | census_block_group + monthweek"
ggplot(data = plot_data, aes(x, y))+
geom_ribbon(data = plot_data, aes(ymin = lower, ymax = upper), linetype=2, alpha = 0.25) +
geom_line(data = plot_data, aes(x, y))+
labs(title = plot_title, x = "num CBGs >= 34C", y = "unit change in MI") +
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
m <- felm(visitors_percap ~ poly(n, 2, raw = T) | census_block_group + monthweek, data = data_subset)
m
summary(m)
data_subset <- data_subset %>% mutate(n_bin = ntile(n, 10))
m <- felm(visitors_percap ~ poly(n, 2,raw=T) | census_block_group + monthweek, data=data_subset)
m <- as.data.frame(cbind(x = 1:10, y = c(0, m$coefficients)))
## plot both the 2018-19 and 2020 data
ggplot(data = m, aes(x, y))+
geom_point(data = m, aes(x, y))+
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
data_subset <- data_subset %>% mutate(n_bin = ntile(n, 10))
m <- felm(visitors_percap ~ as.factor(n_bin) | census_block_group + monthweek, data=data_subset)
m <- as.data.frame(cbind(x = 1:10, y = c(0, m$coefficients)))
## plot both the 2018-19 and 2020 data
ggplot(data = m, aes(x, y))+
geom_point(data = m, aes(x, y))+
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
data_subset <- data_subset %>% mutate(n_bin = ntile(n, 7))
m <- felm(visitors_percap ~ as.factor(n_bin) | census_block_group + monthweek, data=data_subset)
m <- as.data.frame(cbind(x = 1:7, y = c(0, m$coefficients)))
## plot both the 2018-19 and 2020 data
ggplot(data = m, aes(x, y))+
geom_point(data = m, aes(x, y))+
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
data_subset <- data_subset %>% mutate(n_bin = ntile(n, 6))
m <- felm(visitors_percap ~ as.factor(n_bin) | census_block_group + monthweek, data=data_subset)
m <- as.data.frame(cbind(x = 1:6, y = c(0, m$coefficients)))
## plot both the 2018-19 and 2020 data
ggplot(data = m, aes(x, y))+
geom_point(data = m, aes(x, y))+
theme(axis.text.x = element_text(angle = 90)) +
theme_bw()
